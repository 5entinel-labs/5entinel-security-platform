# YARA Rule Project
---

## 🔍 YARA란 무엇인가 (YARA Overview)

YARA는 악성코드 탐지를 위해 널리 사용되는  
**패턴 매칭 기반 정적 분석 도구**입니다.

파일 내부의 문자열, 구조적 특징, 행위 흔적을 기준으로  
악성 여부를 판단하는 룰(rule)을 작성할 수 있습니다.

---

## 🏗 아키텍처 (Architecture)

본 프로젝트의 분석 흐름은 다음과 같습니다.

1. 분석 대상 파일 또는 디렉터리 수집
2. YARA 엔진이 룰 파일(.yar)을 로드
3. 파일 내부 문자열(strings) 및 구조 분석
4. condition 조건에 따른 패턴 매칭
5. 악성 또는 의심 행위 탐지 결과 출력

YARA는 실행을 동반하지 않는 **정적 분석 도구**로
본 프로젝트 역시 파일 기반 탐지에 초점을 맞추고 설계되었습니다.

---

## ⚙️ 주요 기능 (Key Features)

- 웹쉘(WebShell) 및 파일 업로드 공격 탐지
- PHP, Python, Shell 기반 명령 실행 행위 식별
- Base64, zlib 등 난독화된 코드 패턴 탐지
- 단일 문자열 매칭이 아닌 **행위 조합 기반 조건**
- 오탐(False Positive)을 줄이기 위한 다중 조건 구조 적용

---

## 🧩 YARA 룰 구성 요소

YARA 룰은 일반적으로 다음 세 가지 요소로 구성됩니다.

### 1. `meta`
- 룰 설명
- 작성자
- 참고 출처
- 라이선스 정보

### 2. `strings`
- 악성 행위를 나타내는 문자열
- 난독화된 코드 조각
- 명령 실행 및 시스템 호출 패턴

### 3. `condition`
- 문자열 조합 조건
- 파일 크기, 문자열 개수 조건
- 단일 패턴이 아닌 **행위 흐름 중심 탐지**

---
### ⚠️ 주의 사항
**오탐(False Positive) 가능성**
- 문자열 기반 탐지 특성상 정상 파일이 탐지될 수 있음
- 운영 환경 적용 전 충분한 테스트 및 튜닝 필요

**룰 수정 권장**
- 환경별 사용 언어, 프레임워크, 운영체제에 따라
- 문자열
- 조건(condition)
- 파일 크기 제한
- 조정 권장

**샘플 파일 주의**
- 테스트용 샘플이 포함된 경우 절대 로컬 PC에서 실행 금지
- 반드시 격리된 테스트 환경에서만 사용

---

### 🔖 References

- YARA Official Rule Repository  
  https://github.com/Yara-Rules/rules

본 프로젝트의 일부 YARA 룰은 위 공개 저장소를 참고하여  
분석, 수정 및 프로젝트 목적에 맞게 재구성되었습니다.

